<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Заявки до клану</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
body{background: linear-gradient(135deg,#0a0f1e,#121a33); color:#e9efff; font-family:sans-serif;}
.pill{border-radius:999px;}
.card{padding:1rem; border-radius:1rem; background:rgba(255,255,255,0.05); margin-bottom:1rem;}
button{cursor:pointer;}
</style>
</head>
<body class="min-h-screen p-4">
<header class="mb-4">
<h1 class="text-2xl font-bold">⚔️ Заявки на вступ у клан</h1>
<p class="text-slate-300 text-sm">Будь-хто може залишити заявку. Редагування за паролем.</p>
<div class="mt-2 flex gap-2">
<button id="newAppBtn" class="pill bg-blue-500/80 px-4 py-2">Подати анкету</button>
<button id="editBtn" class="pill bg-emerald-500/80 px-4 py-2">Редагувати анкети</button>
</div>
</header>

<main>
<div id="list"></div>
<div id="empty" class="text-center text-slate-400 py-10">Поки що заявок немає.</div>
</main>

<script>
const SECRET_PASS='SlotHim08831';
let canEdit=false;
const BIN_ID='YOUR_BIN_ID';      // тут твій Bin ID
const SECRET_KEY='YOUR_SECRET_KEY'; // тут твій Secret Key
const BIN_URL=`https://api.jsonbin.io/v3/b/${BIN_ID}`;

// Завантаження заявок з JSONbin
async function loadApps(){
  try{
    const res = await fetch(BIN_URL,{
      headers:{'X-Master-Key':SECRET_KEY,'Accept':'application/json'}
    });
    const data = await res.json();
    window.applications = data.record || [];
    renderApplications();
  }catch(e){ window.applications=[]; renderApplications(); }
}

// Збереження заявок
async function saveApps(){
  await fetch(BIN_URL,{
    method:'PUT',
    headers:{
      'Content-Type':'application/json',
      'X-Master-Key':SECRET_KEY,
      'X-Bin-Versioning':'false'
    },
    body:JSON.stringify(window.applications)
  });
  renderApplications();
}

// Відображення заявок
function renderApplications(){
  const list = document.getElementById('list');
  list.innerHTML="";
  if(!window.applications || window.applications.length===0){ document.getElementById('empty').style.display='block'; return; }
  else document.getElementById('empty').style.display='none';

  window.applications.forEach((app,i)=>{
    const card=document.createElement('div');
    card.className='card';
    card.innerHTML=`<strong>${app.nickname}</strong> — ${app.status||'На розгляді'}<br>
      <details><summary>Показати анкету</summary><pre>${JSON.stringify(app,null,2)}</pre></details>
      ${canEdit?`<div class='mt-2 flex gap-2'>
        <button onclick='approve(${i})' class='bg-green-500/80 px-3 py-1 pill'>Схвалити</button>
        <button onclick='reject(${i})' class='bg-red-500/80 px-3 py-1 pill'>Відхилити</button>
        <button onclick='addComment(${i})' class='bg-blue-500/80 px-3 py-1 pill'>Коментар</button>
      </div>`:''}`;
    list.appendChild(card);
  });
}

// Дії редагування
function approve(i){ window.applications[i].status="Схвалено"; saveApps(); }
function reject(i){ window.applications[i].status="Відхилено"; saveApps(); }
function addComment(i){ const c=prompt("Коментар:"); if(c){ window.applications[i].comment=c; saveApps(); } }

// Подати анкету
document.getElementById('newAppBtn').addEventListener('click',()=>{
  const app={};
  app.nickname=prompt("1. Нік у грі:"); if(!app.nickname) return;
  app.id=prompt("2. ID:");
  app.age=prompt("3. Вік:");
  app.timezone=prompt("4. Часовий пояс / місто:");
  app.dailyTime=prompt("5. Скільки часу проводиш у грі щодня:");
  app.serverTime=prompt("6. Скільки часу граєш на сервері:");
  app.prevClans=prompt("7. Попередні клани (якщо були):");
  app.reasonLeave=prompt("8. Причина виходу з попереднього клану:");
  app.reasonJoin=prompt("9. Чому хочеш вступити саме до нашого клану:");
  app.helpClan=prompt("10. Чим готовий допомагати клану:");
  app.discipline=prompt("11. Ставлення до дисципліни та правил:");
  app.voice=prompt("12. Чи є мікрофон та Discord:");
  app.attend=prompt("13. Чи готовий виходити на збори клану:");
  app.rulesKnow=prompt("14. Наскільки добре знаєш правила серверу (1–10):");
  app.skills=prompt("15. Які навички маєш у грі:");
  app.followOrders=prompt("16. Чи готовий виконувати вказівки старших:");
  app.vehicle=prompt("17. Чи є авто/бізнес, яким можеш допомагати:");
  app.ban=prompt("18. Чи був бан/варн на сервері:");
  app.team=prompt("19. Чи готовий працювати в команді:");
  app.extra=prompt("20. Додаткова інформація:");
  app.status="На розгляді"; app.comment="";
  window.applications.push(app); saveApps();
});

// Редагування
document.getElementById('editBtn').addEventListener('click',()=>{
  const p=prompt("Введіть секретний пароль:");
  if(p===SECRET_PASS){ canEdit=true; alert("Доступ увімкнено"); renderApplications(); }
  else alert("Невірний пароль");
});

loadApps();
setInterval(loadApps,60000); // автоматичне оновлення
</script>
</body>
</html>
