<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–û—Ñ—ñ—Å–Ω–∏–π –ö–ª–∞–Ω</title>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>

<style>
/* === –ó–∞–≥–∞–ª—å–Ω–∏–π —Å—Ç–∏–ª—å === */
body {margin:0;padding:0;font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background:#f4f6f8;color:#222;}
.container {max-width:1200px;margin:0 auto;padding:40px;}
h1 {text-align:center;color:#1f4e78;margin-bottom:50px;}
button {padding:15px 30px;border:none;border-radius:8px;background:#1f4e78;color:white;font-size:18px;cursor:pointer;margin:10px;}
button:hover{background:#145290;}
.buttons{text-align:center;margin-top:50px;}

/* === –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ === */
.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);justify-content:center;align-items:center;}
.modal-content{background:#fff;padding:30px;border-radius:12px;max-width:600px;width:90%;max-height:90%;overflow-y:auto;position:relative;}
.close{position:absolute;top:10px;right:15px;font-size:24px;cursor:pointer;color:#333;}
form label{display:block;margin-top:10px;font-weight:bold;}
form input, form textarea{width:100%;padding:10px;margin-top:5px;border-radius:6px;border:1px solid #ccc;font-size:16px;}
form button{width:100%;margin-top:20px;}

/* === –ü–∞–Ω–µ–ª—å –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ === */
.admin-panel{display:none;margin-top:40px;}
.admin-panel h2{text-align:center;color:#1f4e78;}
table{width:100%;border-collapse:collapse;margin-top:20px;}
table,th,td{border:1px solid #ccc;}
th,td{padding:10px;text-align:left;}

/* === –ê–¥–∞–ø—Ç–∏–≤–Ω—ñ—Å—Ç—å === */
@media(max-width:768px){
.modal-content{padding:20px;}
button{width:90%;font-size:16px;}
}
</style>
</head>
<body>

<div class="container">
<h1>–û—Ñ—ñ—Å–Ω–∏–π –ö–ª–∞–Ω ‚öîÔ∏è</h1>

<div class="buttons">
  <button id="openFormBtn">–ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—è</button>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ —Ñ–æ—Ä–º–∏ -->
<div class="modal" id="formModal">
  <div class="modal-content">
    <span class="close" id="closeModal">&times;</span>
    <h2>–§–æ—Ä–º–∞ –∑–∞—è–≤–∫–∏ –Ω–∞ –≤—Å—Ç—É–ø ‚öîÔ∏è</h2>
    <form id="clanForm">
      <label>Email (–¥–ª—è —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó):</label><input type="email" name="email" required>
      <label>üë§ –ù—ñ–∫ —É –≥—Ä—ñ:</label><input type="text" name="nickname" required>
      <label>üÜî ID:</label><input type="text" name="id" required>
      <label>üéÇ –í—ñ–∫:</label><input type="number" name="age" required>
      <label>üåç –ú—ñ—Å—Ç–æ / —á–∞—Å–æ–≤–∏–π –ø–æ—è—Å:</label><input type="text" name="timezone" required>
      <label>‚è∞ –ß–∞—Å —É –≥—Ä—ñ —â–æ–¥–Ω—è:</label><input type="text" name="daily_time" required>
      <label>üìÖ –ß–∞—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ:</label><input type="text" name="server_time" required>
      <label>‚ú® –ß–æ–º—É —Ö–æ—á–µ—à –≤—Å—Ç—É–ø–∏—Ç–∏:</label><textarea name="reason_to_join" required></textarea>
      <label>üí™ –ß–∏–º –¥–æ–ø–æ–º–∞–≥–∞—î—à –∫–ª–∞–Ω—É:</label><textarea name="contribution" required></textarea>
      <button type="submit">–ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –∑–∞—è–≤–∫—É</button>
    </form>
  </div>
</div>

<!-- –ê–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å -->
<div class="admin-panel" id="adminPanel">
<h2>–ê–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å</h2>
<table id="applicationsTable">
<tr><th>Email</th><th>–ù—ñ–∫</th><th>ID</th><th>–í—ñ–∫</th><th>–ú—ñ—Å—Ç–æ</th><th>–ß–∞—Å —É –≥—Ä—ñ</th><th>–ü—Ä–∏—á–∏–Ω–∞</th><th>–î–æ–ø–æ–º–æ–≥–∞</th><th>–î—ñ—ó</th></tr>
</table>
</div>

</div>

<script>
// === Firebase –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è ===
const firebaseConfig = {
  apiKey: "–í–ê–®_API_KEY",
  authDomain: "–í–ê–®_PROJECT_ID.firebaseapp.com",
  databaseURL: "https://–í–ê–®_PROJECT_ID-default-rtdb.firebaseio.com",
  projectId: "–í–ê–®_PROJECT_ID",
  storageBucket: "–í–ê–®_PROJECT_ID.appspot.com",
  messagingSenderId: "–í–ê–®_SENDER_ID",
  appId: "–í–ê–®_APP_ID"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();
const auth = firebase.auth();

// === –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ ===
const modal = document.getElementById("formModal");
document.getElementById("openFormBtn").onclick = ()=>modal.style.display="flex";
document.getElementById("closeModal").onclick = ()=>modal.style.display="none";
window.onclick = e=>{if(e.target==modal) modal.style.display="none";}

// === –õ–æ–≥—ñ–Ω –¥–ª—è –∞–¥–º—ñ–Ω–∞ ===
auth.onAuthStateChanged(user=>{
  if(user && user.email==="bodrosik@gmail.com"){
    document.getElementById("adminPanel").style.display="block";
    loadApplications();
  } else {document.getElementById("adminPanel").style.display="none";}
});
function loginAdmin(){const provider=new firebase.auth.GoogleAuthProvider();auth.signInWithPopup(provider);}
loginAdmin();

// === –í—ñ–¥–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º–∏ ===
document.getElementById("clanForm").addEventListener("submit", function(e){
  e.preventDefault();
  const data={}; new FormData(this).forEach((v,k)=>data[k]=v); data.timestamp=Date.now();
  db.ref("applications").push(data)
    .then(()=>{alert("–ó–∞—è–≤–∫–∞ –Ω–∞–¥—ñ—Å–ª–∞–Ω–∞!"); this.reset(); modal.style.display="none";})
    .catch(err=>alert("–ü–æ–º–∏–ª–∫–∞: "+err));
});

// === –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑–∞—è–≤–æ–∫ –¥–ª—è –∞–¥–º—ñ–Ω–∞ ===
function loadApplications(){
  const table = document.getElementById("applicationsTable");
  db.ref("applications").on("value", snapshot=>{
    table.innerHTML=`<tr><th>Email</th><th>–ù—ñ–∫</th><th>ID</th><th>–í—ñ–∫</th><th>–ú—ñ—Å—Ç–æ</th><th>–ß–∞—Å —É –≥—Ä—ñ</th><th>–ü—Ä–∏—á–∏–Ω–∞</th><th>–î–æ–ø–æ–º–æ–≥–∞</th><th>–î—ñ—ó</th></tr>`;
    snapshot.forEach(child=>{
      const app=child.val();
      const row=table.insertRow();
      row.insertCell(0).innerText=app.email;
      row.insertCell(1).innerText=app.nickname;
      row.insertCell(2).innerText=app.id;
      row.insertCell(3).innerText=app.age;
      row.insertCell(4).innerText=app.timezone;
      row.insertCell(5).innerText=app.daily_time;
      row.insertCell(6).innerText=app.reason_to_join;
      row.insertCell(7).innerText=app.contribution;
      const actionCell=row.insertCell(8);
      const delBtn=document.createElement("button");
      delBtn.innerText="–í–∏–¥–∞–ª–∏—Ç–∏";
      delBtn.onclick=()=>db.ref("applications/"+child.key).remove();
      actionCell.appendChild(delBtn);
    });
  });
}
</script>

</body>
</html>
