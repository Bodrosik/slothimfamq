<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Реєстрація</title>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>

<style>
/* === Загальний офісний стиль === */
body {
  margin:0;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background: #f9f9f9;
  color: #222;
}
.container {
  max-width: 900px;
  margin: 0 auto;
  padding: 50px 20px;
  text-align: center;
}
h1 {
  font-size: 36px;
  margin-bottom: 40px;
  color: #1a3c6e;
}
button {
  background-color: #1a3c6e;
  color: #fff;
  border: none;
  padding: 15px 30px;
  font-size: 18px;
  border-radius: 8px;
  cursor: pointer;
  margin: 10px;
}
button:hover {
  background-color: #145290;
}

/* === Модальне вікно форми === */
.modal {
  display: none;
  position: fixed;
  top:0; left:0; width:100%; height:100%;
  background: rgba(0,0,0,0.6);
  justify-content: center;
  align-items: center;
}
.modal-content {
  background:#fff;
  padding:30px;
  border-radius:12px;
  width:90%;
  max-width:500px;
  max-height:90%;
  overflow-y:auto;
  text-align:left;
  position:relative;
}
.close {
  position:absolute;
  top:10px;
  right:15px;
  font-size:24px;
  cursor:pointer;
  color:#333;
}
form label {
  display:block;
  margin-top:10px;
  font-weight:bold;
}
form input, form textarea {
  width:100%;
  padding:10px;
  margin-top:5px;
  border-radius:6px;
  border:1px solid #ccc;
  font-size:16px;
}
form button {
  width:100%;
  margin-top:20px;
}

/* === Панель адміністратора === */
.admin-panel {
  display:none;
  margin-top:50px;
}
.admin-panel h2 {
  color:#1a3c6e;
  margin-bottom:20px;
}
table {
  width:100%;
  border-collapse: collapse;
}
table, th, td {
  border:1px solid #ccc;
}
th, td {
  padding:10px;
  text-align:left;
}

/* === Адаптивність === */
@media(max-width:768px){
  button{width:90%; font-size:16px;}
  .modal-content{padding:20px;}
}
</style>
</head>
<body>

<div class="container">
<h1>Реєстрація на сайті</h1>

<button id="openFormBtn">Зареєструватися</button>

<!-- Модальне вікно форми -->
<div class="modal" id="formModal">
  <div class="modal-content">
    <span class="close" id="closeModal">&times;</span>
    <h2>Форма реєстрації</h2>
    <form id="regForm">
      <label>Email:</label><input type="email" name="email" required>
      <label>Нік:</label><input type="text" name="nickname" required>
      <label>Додаткові дані:</label><textarea name="info" placeholder="Наприклад, ваш досвід..." ></textarea>
      <button type="submit">Надіслати</button>
    </form>
  </div>
</div>

<!-- Адмін-панель -->
<div class="admin-panel" id="adminPanel">
<h2>Адмін-панель</h2>
<table id="applicationsTable">
<tr><th>Email</th><th>Нік</th><th>Інфо</th><th>Дії</th></tr>
</table>
</div>

</div>

<script>
// === Firebase конфігурація ===
const firebaseConfig = {
  apiKey: "ВАШ_API_KEY",
  authDomain: "ВАШ_PROJECT_ID.firebaseapp.com",
  databaseURL: "https://ВАШ_PROJECT_ID-default-rtdb.firebaseio.com",
  projectId: "ВАШ_PROJECT_ID",
  storageBucket: "ВАШ_PROJECT_ID.appspot.com",
  messagingSenderId: "ВАШ_SENDER_ID",
  appId: "ВАШ_APP_ID"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();
const auth = firebase.auth();

// === Модальне вікно ===
const modal = document.getElementById("formModal");
document.getElementById("openFormBtn").onclick = ()=>modal.style.display="flex";
document.getElementById("closeModal").onclick = ()=>modal.style.display="none";
window.onclick = e=>{if(e.target==modal) modal.style.display="none";}

// === Логін для адміна ===
auth.onAuthStateChanged(user=>{
  if(user && user.email==="bodrosik@gmail.com"){
    document.getElementById("adminPanel").style.display="block";
    loadApplications();
  } else {document.getElementById("adminPanel").style.display="none";}
});
function loginAdmin(){const provider=new firebase.auth.GoogleAuthProvider();auth.signInWithPopup(provider);}
loginAdmin();

// === Відправка форми ===
document.getElementById("regForm").addEventListener("submit", function(e){
  e.preventDefault();
  const data={}; new FormData(this).forEach((v,k)=>data[k]=v); data.timestamp=Date.now();
  db.ref("registrations").push(data)
    .then(()=>{alert("Реєстрація успішна!"); this.reset(); modal.style.display="none";})
    .catch(err=>alert("Помилка: "+err));
});

// === Завантаження заявок для адміна ===
function loadApplications(){
  const table = document.getElementById("applicationsTable");
  db.ref("registrations").on("value", snapshot=>{
    table.innerHTML=`<tr><th>Email</th><th>Нік</th><th>Інфо</th><th>Дії</th></tr>`;
    snapshot.forEach(child=>{
      const app=child.val();
      const row=table.insertRow();
      row.insertCell(0).innerText=app.email;
      row.insertCell(1).innerText=app.nickname;
      row.insertCell(2).innerText=app.info;
      const actionCell=row.insertCell(3);
      const delBtn=document.createElement("button");
      delBtn.innerText="Видалити";
      delBtn.onclick=()=>db.ref("registrations/"+child.key).remove();
      actionCell.appendChild(delBtn);
    });
  });
}
</script>

</body>
</html>
